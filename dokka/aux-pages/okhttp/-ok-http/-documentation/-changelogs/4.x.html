<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <title>4.x</title>
    <link href="../../../images/logo-icon.svg" rel="icon" type="image/svg">
    <script>var pathToRoot = "../../../";</script>
    <script>const storage = localStorage.getItem("dokka-dark-mode")
    if (storage == null) {
        const osDarkSchemePreferred = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches
        if (osDarkSchemePreferred === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    } else {
        const savedDarkMode = JSON.parse(storage)
        if(savedDarkMode === true) {
            document.getElementsByTagName("html")[0].classList.add("theme-dark")
        }
    }
    </script>
<script type="text/javascript" src="../../../scripts/sourceset_dependencies.js" async="async"></script>
<link href="../../../styles/style.css" rel="Stylesheet">
<link href="../../../styles/jetbrains-mono.css" rel="Stylesheet">
<link href="../../../styles/main.css" rel="Stylesheet">
<link href="../../../styles/prism.css" rel="Stylesheet">
<link href="../../../styles/logo-styles.css" rel="Stylesheet">
<script type="text/javascript" src="../../../scripts/clipboard.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/navigation-loader.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/platform-content-handler.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/main.js" defer="defer"></script>
<script type="text/javascript" src="../../../scripts/prism.js" async="async"></script>
<script type="text/javascript" src="../../../scripts/symbol-parameters-wrapper_deferred.js" defer="defer"></script>
</head>
<body>
<div class="navigation-wrapper" id="navigation-wrapper">
    <div id="leftToggler"><span class="icon-toggler"></span></div>
    <div class="library-name">
            <a href="../../../index.html">
                    <span>OkHttp</span>
            </a>
    </div>
    <div>
4.X    </div>
    <div class="pull-right d-flex">
        <button id="theme-toggle-button"><span id="theme-toggle"></span></button>
        <div id="searchBar"></div>
    </div>
</div>
<div id="container">
    <div id="leftColumn">
        <div id="sideMenu"></div>
    </div>
    <div id="main">
<div class="main-content" id="content" pageIds="OkHttp::.aux_doc/4.x///PointingToDeclaration//0">
  <div class="breadcrumbs"><a href="../../../index.html">OkHttp</a><span class="delimiter">/</span><span class="current">4.x</span></div>
  <div class="cover ">
    <div class="cover ">
      <h1 class=""> OkHttp 4.x Change Log</h1>
      <h2 class=""> Version 4.11.0</h2>
      <p class="paragraph"><i>2023-04-22</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Don't fail the call when the response code is ‘HTTP 102 Processing’ or     ‘HTTP 103 Early Hints’.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Read the response even if writing the request fails. This means you'll get a proper HTTP     response even if the server rejects your request body.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Use literal IP addresses directly rather than passing them to <code class="lang-kotlin">DnsOverHttps</code>.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Embed Proguard rules to prevent warnings from tools like DexGuard and R8. These warnings     were triggered by OkHttp’s feature detection for TLS packages like <code class="lang-kotlin">org.conscrypt</code>,     <code class="lang-kotlin">org.bouncycastle</code>, and <code class="lang-kotlin">org.openjsse</code>.</p>
        </li>
        <li>
          <p class="paragraph">Upgrade: Explicitly depend on <code class="lang-kotlin">kotlin-stdlib-jdk8</code>. This fixes a problem with dependency     locking. That's a potential security vulnerability, tracked as <span data-unresolved-link=".aux_doc/CVE-2022-24329///PointingToDeclaration/">CVE-2022-24329</span>.</p>
        </li>
        <li>
          <p class="paragraph">Upgrade: <span data-unresolved-link=".aux_doc/public_suffix///PointingToDeclaration/">publicsuffix.org data</span>. This powers <code class="lang-kotlin">HttpUrl.topPrivateDomain()</code>.     It's also how OkHttp knows which domains can share cookies with one another.</p>
        </li>
        <li>
          <p class="paragraph">Upgrade: <span data-unresolved-link=".aux_doc/okio_3_2_0///PointingToDeclaration/">Okio 3.2.0</span>.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.10.0</h2>
      <p class="paragraph"><i>2022-06-12</i></p>
      <ul>
        <li>
          <p class="paragraph">Upgrade: <span data-unresolved-link=".aux_doc/kotlin_1_6_20///PointingToDeclaration/">Kotlin 1.6.20</span>.</p>
        </li>
        <li>
          <p class="paragraph">Upgrade: <span data-unresolved-link=".aux_doc/okio_3_0_0///PointingToDeclaration/">Okio 3.0.0</span>.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Recover gracefully when Android's <code class="lang-kotlin">NativeCrypto</code> crashes with <code class="lang-kotlin">&quot;ssl == null&quot;</code>. This occurs     when OkHttp retrieves ALPN state on a closed connection.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.9.3</h2>
      <p class="paragraph"><i>2021-11-21</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Don't fail HTTP/2 responses if they complete before a <code class="lang-kotlin">RST_STREAM</code> is sent.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.9.2</h2>
      <p class="paragraph"><i>2021-09-30</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Don't include potentially-sensitive header values in <code class="lang-kotlin">Headers.toString()</code> or exceptions.     This applies to <code class="lang-kotlin">Authorization</code>, <code class="lang-kotlin">Cookie</code>, <code class="lang-kotlin">Proxy-Authorization</code>, and <code class="lang-kotlin">Set-Cookie</code> headers.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't crash with an <code class="lang-kotlin">InaccessibleObjectException</code> when running on JDK17+ with strong     encapsulation enabled.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Strictly verify hostnames used with OkHttp's <code class="lang-kotlin">HostnameVerifier</code>. Programs that make direct     manual calls to <code class="lang-kotlin">HostnameVerifier</code> could be defeated if the hostnames they pass in are not     strictly ASCII. This issue is tracked as <span data-unresolved-link=".aux_doc/CVE-2021-0341///PointingToDeclaration/">CVE-2021-0341</span>.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.9.1</h2>
      <p class="paragraph"><i>2021-01-30</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Work around a crash in Android 10 and 11 that may be triggered when two threads     concurrently close an SSL socket. This would have appeared in crash logs as     <code class="lang-kotlin">NullPointerException: bio == null</code>.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.9.0</h2>
      <p class="paragraph"><i>2020-09-11</i></p>
      <p class="paragraph"><strong>With this release, </strong><code class="strong lang-kotlin"><strong>okhttp-tls</strong></code><strong> no longer depends on Bouncy Castle and doesn't install the Bouncy Castle security provider.</strong> If you still need it, you can do it yourself:</p>
      <div class="sample-container">
        <pre><code class="block lang-kotlin" theme="idea">Security.addProvider(BouncyCastleProvider())</code></pre>
<span class="top-right-position"><span class="copy-icon"></span>
          <div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div>
        </span></div>
      <p class="paragraph">You will also need to configure this dependency:</p>
      <div class="sample-container">
        <pre><code class="block lang-kotlin" theme="idea">dependencies {<br>  implementation &quot;org.bouncycastle:bcprov-jdk15on:1.65&quot;<br>}</code></pre>
<span class="top-right-position"><span class="copy-icon"></span>
          <div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div>
        </span></div>
      <ul>
        <li>
          <p class="paragraph">Upgrade: <span data-unresolved-link=".aux_doc/kotlin_1_4_10///PointingToDeclaration/">Kotlin 1.4.10</span>. We now use Kotlin 1.4.x <span data-unresolved-link=".aux_doc/fun_interface///PointingToDeclaration/">functional     interfaces</span> for <code class="lang-kotlin">Authenticator</code>, <code class="lang-kotlin">Interceptor</code>, and others.</p>
        </li>
        <li>
          <p class="paragraph">Upgrade: Build with Conscrypt 2.5.1.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.8.1</h2>
      <p class="paragraph"><i>2020-08-06</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Don't crash in <code class="lang-kotlin">HeldCertificate.Builder</code> when creating certificates on older versions of     Android, including Android 6. We were using a feature of <code class="lang-kotlin">SimpleDateFormat</code> that wasn't     available in those versions!</p>
        </li>
      </ul>
      <h2 class=""> Version 4.8.0</h2>
      <p class="paragraph"><i>2020-07-11</i></p>
      <ul>
        <li>
          <p class="paragraph">New: Change <code class="lang-kotlin">HeldCertificate.Builder</code> to use its own ASN.1 certificate encoder. This is part     of our effort to remove the okhttp-tls module's dependency on Bouncy Castle. We think Bouncy     Castle is great! But it's a large dependency (6.5 MiB) and its security provider feature     impacts VM-wide behavior.</p>
        </li>
        <li>
          <p class="paragraph">New: Reduce contention for applications that make a very high number of concurrent requests.     Previously OkHttp used its connection pool as a lock when making changes to connections and     calls. With this change each connection is locked independently.</p>
        </li>
        <li>
          <p class="paragraph">Upgrade: <span data-unresolved-link=".aux_doc/okio_2_7_0///PointingToDeclaration/">Okio 2.7.0</span>.</p>
          <div class="sample-container">
            <pre><code class="block lang-kotlin" theme="idea">implementation(&quot;com.squareup.okio:okio:2.7.0&quot;)</code></pre>
<span class="top-right-position"><span class="copy-icon"></span>
              <div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div>
            </span></div>
        </li>
        <li>
          <p class="paragraph">Fix: Avoid log messages like &quot;Didn't find class org.conscrypt.ConscryptHostnameVerifier&quot; when     detecting the TLS capabilities of the host platform.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't crash in <code class="lang-kotlin">HttpUrl.topPrivateDomain()</code> when the hostname is malformed.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't attempt Brotli decompression if the response body is empty.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.7.2</h2>
      <p class="paragraph"><i>2020-05-20</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Don't crash inspecting whether the host platform is JVM or Android. With 4.7.0 and 4.7.1 we     had a crash <code class="lang-kotlin">IllegalArgumentException: Not a Conscrypt trust manager</code> because we depended on     initialization order of companion objects.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.7.1</h2>
      <p class="paragraph"><i>2020-05-18</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Pass the right arguments in the trust manager created for <code class="lang-kotlin">addInsecureHost()</code>. Without the     fix insecure hosts crash with an <code class="lang-kotlin">IllegalArgumentException</code> on Android.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.7.0</h2>
      <p class="paragraph"><i>2020-05-17</i></p>
      <ul>
        <li>
          <p class="paragraph">New: <code class="lang-kotlin">HandshakeCertificates.Builder.addInsecureHost()</code> makes it easy to turn off security in     private development environments that only carry test data. Prefer this over creating an     all-trusting <code class="lang-kotlin">TrustManager</code> because only hosts on the allowlist are insecure. From     <span data-unresolved-link=".aux_doc/dev_server///PointingToDeclaration/">our DevServer sample</span>:</p>
          <div class="sample-container">
            <pre><code class="block lang-kotlin" theme="idea">val clientCertificates = HandshakeCertificates.Builder()<br>    .addPlatformTrustedCertificates()<br>    .addInsecureHost(&quot;localhost&quot;)<br>    .build()<br><br>val client = OkHttpClient.Builder()<br>    .sslSocketFactory(clientCertificates.sslSocketFactory(), clientCertificates.trustManager)<br>    .build()</code></pre>
<span class="top-right-position"><span class="copy-icon"></span>
              <div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div>
            </span></div>
        </li>
        <li>
          <p class="paragraph">New: Add <code class="lang-kotlin">cacheHit</code>, <code class="lang-kotlin">cacheMiss</code>, and <code class="lang-kotlin">cacheConditionalHit()</code> events to <code class="lang-kotlin">EventListener</code>. Use     these in logs, metrics, and even test cases to confirm your cache headers are configured as     expected.</p>
        </li>
        <li>
          <p class="paragraph">New: Constant string <code class="lang-kotlin">okhttp3.VERSION</code>. This is a string like &quot;4.5.0-RC1&quot;, &quot;4.5.0&quot;, or     &quot;4.6.0-SNAPSHOT&quot; indicating the version of OkHttp in the current runtime. Use this to include     the OkHttp version in custom <code class="lang-kotlin">User-Agent</code> headers.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't crash when running as a plugin in Android Studio Canary 4.1. To enable     platform-specific TLS features OkHttp must detect whether it's running in a JVM or in Android.     The upcoming Android Studio runs in a JVM but has classes from Android and that confused OkHttp!</p>
        </li>
        <li>
          <p class="paragraph">Fix: Include the header <code class="lang-kotlin">Accept: text/event-stream</code> for SSE calls. This header is not added if     the request already contains an <code class="lang-kotlin">Accept</code> header.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't crash with a <code class="lang-kotlin">NullPointerException</code> if a server sends a close while we're sending a     ping. OkHttp had a race condition bug.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.6.0</h2>
      <p class="paragraph"><i>2020-04-28</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Follow HTTP 307 and 308 redirects on methods other than GET and POST. We're reluctant to     change OkHttp's behavior in handling common HTTP status codes, but this fix is overdue! The new     behavior is now consistent with <span data-unresolved-link=".aux_doc/rfc_7231_647///PointingToDeclaration/">RFC 7231</span>, which is newer than OkHttp itself.     If you want this update with the old behavior use <span data-unresolved-link=".aux_doc/legacy_interceptor///PointingToDeclaration/">this interceptor</span>.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't crash decompressing web sockets messages. We had a bug where we assumed deflated     bytes in would always yield deflated bytes out and this isn't always the case!</p>
        </li>
        <li>
          <p class="paragraph">Fix: Reliably update and invalidate the disk cache on windows. As originally designed our     internal <code class="lang-kotlin">DiskLruCache</code> assumes an inode-like file system, where it's fine to delete files that     are currently being read or written. On Windows the file system forbids this so we must be more     careful when deleting and renaming files.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't crash on Java 8u252 which introduces an API previously found only on Java 9 and     above. See <span data-unresolved-link=".aux_doc/jetty_8_252///PointingToDeclaration/">Jetty's overview</span> of the API change and its consequences.</p>
        </li>
        <li>
          <p class="paragraph">New: <code class="lang-kotlin">MultipartReader</code> is a streaming decoder for <span data-unresolved-link=".aux_doc/rfc_2045///PointingToDeclaration/">MIME multipart (RFC 2045)</span>     messages. It complements <code class="lang-kotlin">MultipartBody</code> which is our streaming encoder.</p>
          <div class="sample-container">
            <pre><code class="block lang-kotlin" theme="idea">val response: Response = call.execute()<br>val multipartReader = MultipartReader(response.body!!)<br><br>multipartReader.use {<br>  while (true) {<br>    val part = multipartReader.nextPart() ?: break<br>    process(part.headers, part.body)<br>  }<br>}</code></pre>
<span class="top-right-position"><span class="copy-icon"></span>
              <div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div>
            </span></div>
        </li>
        <li>
          <p class="paragraph">New: <code class="lang-kotlin">MediaType.parameter()</code> gets a parameter like <code class="lang-kotlin">boundary</code> from a media type like     <code class="lang-kotlin">multipart/mixed; boundary=&quot;abc&quot;</code>.</p>
        </li>
        <li>
          <p class="paragraph">New: <code class="lang-kotlin">Authenticator.JAVA_NET_AUTHENTICATOR</code> forwards authentication requests to     <code class="lang-kotlin">java.net.Authenticator</code>. This obsoletes <code class="lang-kotlin">JavaNetAuthenticator</code> in the <code class="lang-kotlin">okhttp-urlconnection</code>     module.</p>
        </li>
        <li>
          <p class="paragraph">New: <code class="lang-kotlin">CertificatePinner</code> now offers an API for inspecting the configured pins.</p>
        </li>
        <li>
          <p class="paragraph">Upgrade: <span data-unresolved-link=".aux_doc/okio_2_6_0///PointingToDeclaration/">Okio 2.6.0</span>.</p>
          <div class="sample-container">
            <pre><code class="block lang-kotlin" theme="idea">implementation(&quot;com.squareup.okio:okio:2.6.0&quot;)</code></pre>
<span class="top-right-position"><span class="copy-icon"></span>
              <div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div>
            </span></div>
        </li>
        <li>
          <p class="paragraph">Upgrade: <span data-unresolved-link=".aux_doc/public_suffix///PointingToDeclaration/">publicsuffix.org data</span>. This powers <code class="lang-kotlin">HttpUrl.topPrivateDomain()</code>.     It's also how OkHttp knows which domains can share cookies with one another.</p>
        </li>
        <li>
          <p class="paragraph">Upgrade: <span data-unresolved-link=".aux_doc/bouncy_castle_releases///PointingToDeclaration/">Bouncy Castle 1.65</span>. This dependency is required by the     <code class="lang-kotlin">okhttp-tls</code> module.</p>
        </li>
        <li>
          <p class="paragraph">Upgrade: <span data-unresolved-link=".aux_doc/kotlin_1_3_71///PointingToDeclaration/">Kotlin 1.3.71</span>.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.5.0</h2>
      <p class="paragraph"><i>2020-04-06</i></p>
      <p class="paragraph"><strong>This release fixes a severe bug where OkHttp incorrectly detected and recovered from unhealthy connections.</strong> Stale or canceled connections were incorrectly attempted when they shouldn't have been, leading to rare cases of infinite retries. Please upgrade to this release!</p>
      <ul>
        <li>
          <p class="paragraph">Fix: don't return stale DNS entries in <code class="lang-kotlin">DnsOverHttps</code>. We were caching DNS results indefinitely     rather than the duration specified in the response's cache-control header.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Verify certificate IP addresses in canonical form. When a server presents a TLS certificate     containing an IP address we must match that address against the URL's IP address, even when the     two addresses are encoded differently, such as <code class="lang-kotlin">192.168.1.1</code> and <code class="lang-kotlin">0::0:0:FFFF:C0A8:101</code>. Note     that OkHttp incorrectly rejected valid certificates resulting in a failure to connect; at no     point were invalid certificates accepted.</p>
        </li>
        <li>
          <p class="paragraph">New: <code class="lang-kotlin">OkHttpClient.Builder.minWebSocketMessageToCompress()</code> configures a threshold for     compressing outbound web socket messages. Configure this with 0L to always compress outbound     messages and <code class="lang-kotlin">Long.MAX_VALUE</code> to never compress outbound messages. The default is 1024L which     compresses messages of size 1 KiB and larger. (Inbound messages are compressed or not based on     the web socket server's configuration.)</p>
        </li>
        <li>
          <p class="paragraph">New: Defer constructing <code class="lang-kotlin">Inflater</code> and <code class="lang-kotlin">Deflater</code> instances until they are needed. This saves     memory if web socket compression is negotiated but not used.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.5.0-RC1</h2>
      <p class="paragraph"><i>2020-03-17</i></p>
      <p class="paragraph"><strong>This release candidate turns on web socket compression.</strong></p>
      <p class="paragraph">The <span data-unresolved-link=".aux_doc/rfc_7692///PointingToDeclaration/">spec</span> includes a sophisticated mechanism for client and server to negotiate compression features. We strive to offer great performance in our default configuration and so we're making compression the default for everyone starting with this release candidate.</p>
      <p class="paragraph">Please be considerate of your servers and their operators as you roll out this release. Compression saves bandwidth but it costs CPU and memory! If you run into a problem you may need to adjust or disable the <code class="lang-kotlin">permessage-deflate</code> compression settings on your server.</p>
      <p class="paragraph">Note that OkHttp won't use compression when sending messages smaller than 1 KiB.</p>
      <ul>
        <li>
          <p class="paragraph">Fix: Don't crash when the URL hostname contains an underscore on Android.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Change HTTP/2 to use a daemon thread for its socket reader. If you've ever seen a command     line application hang after all of the work is done, it may be due to a non-daemon thread like     this one.</p>
        </li>
        <li>
          <p class="paragraph">New: Include suppressed exceptions when all routes to a target service fail.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.4.1</h2>
      <p class="paragraph"><i>2020-03-08</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Don't reuse a connection on redirect if certs match but DNS does not. For better     locality and performance OkHttp attempts to use the same pooled connection across redirects and     follow-ups. It independently shares connections when the IP addresses and certificates match,     even if the host names do not. In 4.4.0 we introduced a regression where we shared a connection     when certificates matched but the DNS addresses did not. This would only occur when following a     redirect from one hostname to another, and where both hosts had common certificates.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't fail on a redirect when a client has configured a 'trust everything' trust manager.     Typically this would cause certain redirects to fail in debug and development configurations.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.4.0</h2>
      <p class="paragraph"><i>2020-02-17</i></p>
      <ul>
        <li>
          <p class="paragraph">New: Support <code class="lang-kotlin">canceled()</code> as an event that can be observed by <code class="lang-kotlin">EventListener</code>. This should be     useful for splitting out canceled calls in metrics.</p>
        </li>
        <li>
          <p class="paragraph">New: Publish a <span data-unresolved-link=".aux_doc/bom///PointingToDeclaration/">bill of materials (BOM)</span> for OkHttp. Depend on this from Gradle or Maven to     keep all of your OkHttp artifacts on the same version, even if they're declared via transitive     dependencies. You can even omit versions when declaring other OkHttp dependencies.</p>
          <div class="sample-container">
            <pre><code class="block lang-kotlin" theme="idea">dependencies {<br>   api(platform(&quot;com.squareup.okhttp3:okhttp-bom:4.4.0&quot;))<br>   api(&quot;com.squareup.okhttp3:okhttp&quot;)              // No version!<br>   api(&quot;com.squareup.okhttp3:logging-interceptor&quot;) // No version!<br>}</code></pre>
<span class="top-right-position"><span class="copy-icon"></span>
              <div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div>
            </span></div>
        </li>
        <li>
          <p class="paragraph">New: Upgrade to Okio 2.4.3.</p>
          <div class="sample-container">
            <pre><code class="block lang-kotlin" theme="idea">implementation(&quot;com.squareup.okio:okio:2.4.3&quot;)</code></pre>
<span class="top-right-position"><span class="copy-icon"></span>
              <div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div>
            </span></div>
        </li>
        <li>
          <p class="paragraph">Fix: Limit retry attempts for HTTP/2 <code class="lang-kotlin">REFUSED_STREAM</code> and <code class="lang-kotlin">CANCEL</code> failures.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Retry automatically when incorrectly sharing a connection among multiple hostnames. OkHttp     shares connections when hosts share both IP addresses and certificates, such as <code class="lang-kotlin">squareup.com</code>     and <code class="lang-kotlin">www.squareup.com</code>. If a server refuses such sharing it will return HTTP 421 and OkHttp will     automatically retry on an unshared connection.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't crash if a TLS tunnel's response body is truncated.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't track unusable routes beyond their usefulness. We had a bug where we could track     certain bad routes indefinitely; now we only track the ones that could be necessary.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Defer proxy selection until a proxy is required. This saves calls to <code class="lang-kotlin">ProxySelector</code> on     calls that use a pooled connection.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.3.1</h2>
      <p class="paragraph"><i>2020-01-07</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Don't crash with a <code class="lang-kotlin">NullPointerException</code> when a web socket is closed before it connects.     This regression was introduced in OkHttp 4.3.0.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't crash with an <code class="lang-kotlin">IllegalArgumentException</code> when using custom trust managers on     Android 10. Android uses reflection to look up a magic <code class="lang-kotlin">checkServerTrusted()</code> method and we     didn't have it.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Explicitly specify the remote server name when making HTTPS connections on Android 5. In     4.3.0 we introduced a regression where server name indication (SNI) was broken on Android 5.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.3.0</h2>
      <p class="paragraph"><i>2019-12-31</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Degrade HTTP/2 connections after a timeout. When an HTTP/2 stream times out it may impact     the stream only or the entire connection. With this fix OkHttp will now send HTTP/2 pings after     a stream timeout to determine whether the connection should remain eligible for pooling.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't call <code class="lang-kotlin">EventListener.responseHeadersStart()</code> or <code class="lang-kotlin">responseBodyStart()</code> until bytes have     been received. Previously these events were incorrectly sent too early, when OkHttp was ready to     read the response headers or body, which mislead tracing tools. Note that the <code class="lang-kotlin">responseFailed()</code>     event always used to follow one of these events; now it may be sent without them.</p>
        </li>
        <li>
          <p class="paragraph">New: Upgrade to Kotlin 1.3.61.</p>
        </li>
        <li>
          <p class="paragraph">New: Match any number of subdomains with two asterisks in <code class="lang-kotlin">CertificatePinner</code>. For example,     <code class="lang-kotlin">**.squareup.com</code> matches <code class="lang-kotlin">us-west.www.squareup.com</code>, <code class="lang-kotlin">www.squareup.com</code> and <code class="lang-kotlin">squareup.com</code>.</p>
        </li>
        <li>
          <p class="paragraph">New: Share threads more aggressively between OkHttp's HTTP/2 connections, connection pool,     web sockets, and cache. OkHttp has a new internal task runner abstraction for managed task     scheduling. In your debugger you will see new thread names and more use of daemon threads.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't drop callbacks on unexpected exceptions. When an interceptor throws an unchecked     exception the callback is now notified that the call was canceled. The exception is still sent     to the uncaught exception handler for reporting and recovery.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Un-deprecate <code class="lang-kotlin">MockResponse.setHeaders()</code> and other setters. These were deprecated in OkHttp     4.0 but that broke method chaining for Java callers.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't crash on HTTP/2 HEAD requests when the <code class="lang-kotlin">Content-Length</code> header is present but is not     consistent with the length of the response body.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't crash when converting a <code class="lang-kotlin">HttpUrl</code> instance with an unresolvable hostname to a URI.     The new behavior strips invalid characters like <code class="lang-kotlin">&quot;</code> and <code class="lang-kotlin">{</code> from the hostname before converting.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Undo a performance regression introduced in OkHttp 4.0 caused by differences in behavior     between Kotlin's <code class="lang-kotlin">assert()</code> and Java's <code class="lang-kotlin">assert()</code>. (Kotlin always evaluates the argument; Java     only does when assertions are enabled.)</p>
        </li>
        <li>
          <p class="paragraph">Fix: Honor <code class="lang-kotlin">RequestBody.isOneShot()</code> in <code class="lang-kotlin">HttpLoggingInterceptor</code>.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.2.2</h2>
      <p class="paragraph"><i>2019-10-06</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: When closing a canceled HTTP/2 stream, don't send the <code class="lang-kotlin">END_STREAM</code> flag. This could cause     the server to incorrectly interpret the stream as having completed normally. This is most useful     when a request body needs to cancel its own call.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.2.1</h2>
      <p class="paragraph"><i>2019-10-02</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: In 4.1.0 we introduced a performance regression that prevented connections from being     pooled in certain situations. We have good test coverage for connection pooling but we missed     this because it only occurs if you have proxy configured and you share a connection pool among     multiple <code class="lang-kotlin">OkHttpClient</code> instances.</p>
          <p class="paragraph">This particularly-subtle bug was caused by us assigning each <code class="lang-kotlin">OkHttpClient</code> instance its own     <code class="lang-kotlin">NullProxySelector</code> when an explicit proxy is configured. But we don't share connections when     the proxy selectors are different. Ugh!</p>
        </li>
      </ul>
      <h2 class=""> Version 4.2.0</h2>
      <p class="paragraph"><i>2019-09-10</i></p>
      <ul>
        <li>
          <p class="paragraph">New: API to decode a certificate and private key to create a <code class="lang-kotlin">HeldCertificate</code>. This accepts a     string containing both a certificate and PKCS #8-encoded private key.</p>
          <div class="sample-container">
            <pre><code class="block lang-kotlin" theme="idea">val heldCertificate = HeldCertificate.decode(&quot;&quot;&quot;<br>    |-----BEGIN CERTIFICATE-----<br>    |MIIBYTCCAQegAwIBAgIBKjAKBggqhkjOPQQDAjApMRQwEgYDVQQLEwtlbmdpbmVl<br>    |cmluZzERMA8GA1UEAxMIY2FzaC5hcHAwHhcNNzAwMTAxMDAwMDA1WhcNNzAwMTAx<br>    |MDAwMDEwWjApMRQwEgYDVQQLEwtlbmdpbmVlcmluZzERMA8GA1UEAxMIY2FzaC5h<br>    |cHAwWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAASda8ChkQXxGELnrV/oBnIAx3dD<br>    |ocUOJfdz4pOJTP6dVQB9U3UBiW5uSX/MoOD0LL5zG3bVyL3Y6pDwKuYvfLNhoyAw<br>    |HjAcBgNVHREBAf8EEjAQhwQBAQEBgghjYXNoLmFwcDAKBggqhkjOPQQDAgNIADBF<br>    |AiAyHHg1N6YDDQiY920+cnI5XSZwEGhAtb9PYWO8bLmkcQIhAI2CfEZf3V/obmdT<br>    |yyaoEufLKVXhrTQhRfodTeigi4RX<br>    |-----END CERTIFICATE-----<br>    |-----BEGIN PRIVATE KEY-----<br>    |MEECAQAwEwYHKoZIzj0CAQYIKoZIzj0DAQcEJzAlAgEBBCA7ODT0xhGSNn4ESj6J<br>    |lu/GJQZoU9lDrCPeUcQ28tzOWw==<br>    |-----END PRIVATE KEY-----<br>    &quot;&quot;&quot;.trimMargin())<br>val handshakeCertificates = HandshakeCertificates.Builder()<br>    .heldCertificate(heldCertificate)<br>    .build()<br>val server = MockWebServer()<br>server.useHttps(handshakeCertificates.sslSocketFactory(), false)</code></pre>
<span class="top-right-position"><span class="copy-icon"></span>
              <div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div>
            </span></div>
          <p class="paragraph">Get these strings with <code class="lang-kotlin">HeldCertificate.certificatePem()</code> and <code class="lang-kotlin">privateKeyPkcs8Pem()</code>.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Handshake now returns peer certificates in canonical order: each certificate is signed by     the certificate that follows and the last certificate is signed by a trusted root.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't lose HTTP/2 flow control bytes when incoming data races with a stream close. If this     happened enough then eventually the connection would stall.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Acknowledge and apply inbound HTTP/2 settings atomically. Previously we had a race where we     could use new flow control capacity before acknowledging it, causing strict HTTP/2 servers to     fail the call.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.1.1</h2>
      <p class="paragraph"><i>2019-09-05</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Don't drop repeated headers when validating cached responses. In our Kotlin upgrade we     introduced a regression where we iterated the number of unique header names rather than then     number of unique headers. If you're using OkHttp's response cache this may impact you.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.1.0</h2>
      <p class="paragraph"><i>2019-08-12</i></p>
      <ul>
        <li>
          <p class="paragraph"><strong>OkHttp's new okhttp-brotli module implements Brotli compression.</strong> Install the interceptor to     enable <span data-unresolved-link=".aux_doc/brotli///PointingToDeclaration/">Brotli compression</span>, which compresses 5-20% smaller than gzip.</p>
          <div class="sample-container">
            <pre><code class="block lang-kotlin" theme="idea">val client = OkHttpClient.Builder()<br>    .addInterceptor(BrotliInterceptor)<br>    .build()</code></pre>
<span class="top-right-position"><span class="copy-icon"></span>
              <div class="copy-popup-wrapper popup-to-left"><span class="copy-popup-icon"></span><span>Content copied to clipboard</span></div>
            </span></div>
          <p class="paragraph">This artifact has a dependency on Google's Brotli decoder (95 KiB).</p>
        </li>
        <li>
          <p class="paragraph">New: <code class="lang-kotlin">EventListener.proxySelectStart()</code>, <code class="lang-kotlin">proxySelectEnd()</code> events give visibility into the     proxy selection process.</p>
        </li>
        <li>
          <p class="paragraph">New: <code class="lang-kotlin">Response.byteString()</code> reads the entire response into memory as a byte string.</p>
        </li>
        <li>
          <p class="paragraph">New: <code class="lang-kotlin">OkHttpClient.x509TrustManager</code> accessor.</p>
        </li>
        <li>
          <p class="paragraph">New: Permit <span data-unresolved-link=".aux_doc/iana_websocket///PointingToDeclaration/">new WebSocket response codes</span>: 1012 (Service Restart), 1013 (Try     Again Later), and 1014 (invalid response from the upstream).</p>
        </li>
        <li>
          <p class="paragraph">New: Build with Kotlin 1.3.41, BouncyCastle 1.62, and Conscrypt 2.2.1.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Recover gracefully when a coalesced connection immediately goes unhealthy.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Defer the <code class="lang-kotlin">SecurityException</code> when looking up the default proxy selector.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't use brackets formatting IPv6 host names in MockWebServer.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Don't permit cache iterators to remove entries that are being written.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.0.1</h2>
      <p class="paragraph"><i>2019-07-10</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Tolerate null-hostile lists in public API. Lists created with <code class="lang-kotlin">List.of(...)</code> don't like it     when you call <code class="lang-kotlin">contains(null)</code> on them!</p>
        </li>
        <li>
          <p class="paragraph">Fix: Retain binary-compatibility in <code class="lang-kotlin">okhttp3.internal.HttpHeaders.hasBody()</code>. Some unscrupulous     coders call this and we don't want their users to suffer.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.0.0</h2>
      <p class="paragraph"><i>2019-06-26</i></p>
      <p class="paragraph"><strong>This release upgrades OkHttp to Kotlin.</strong> We tried our best to make fast and safe to upgrade from OkHttp 3.x. We wrote an <a href="-upgrade to -ok-http 4.html">upgrade guide</a> to help with the migration and a <span data-unresolved-link=".aux_doc/okhttp4_blog_post///PointingToDeclaration/">blog post</span> to explain it.</p>
      <ul>
        <li>
          <p class="paragraph">Fix: Target Java 8 bytecode for Java and Kotlin.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.0.0-RC3</h2>
      <p class="paragraph"><i>2019-06-24</i></p>
      <ul>
        <li>
          <p class="paragraph">Fix: Retain binary-compatibility in <code class="lang-kotlin">okhttp3.internal.HttpMethod</code>. Naughty third party SDKs     import this and we want to ease upgrades for their users.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.0.0-RC2</h2>
      <p class="paragraph"><i>2019-06-21</i></p>
      <ul>
        <li>
          <p class="paragraph">New: Require Kotlin 1.3.40.</p>
        </li>
        <li>
          <p class="paragraph">New: Change the Kotlin API from <code class="lang-kotlin">File.toRequestBody()</code> to <code class="lang-kotlin">File.asRequestBody()</code> and     <code class="lang-kotlin">BufferedSource.toResponseBody()</code> to <code class="lang-kotlin">BufferedSource.asResponseBody()</code>. If the returned value     is a view of what created it, we use <i>as</i>.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Permit response codes of zero for compatibility with OkHttp 3.x.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Change the return type of <code class="lang-kotlin">MockWebServer.takeRequest()</code> to be nullable.</p>
        </li>
        <li>
          <p class="paragraph">Fix: Make <code class="lang-kotlin">Call.clone()</code> public to Kotlin callers.</p>
        </li>
      </ul>
      <h2 class=""> Version 4.0.0-RC1</h2>
      <p class="paragraph"><i>2019-06-03</i></p>
      <ul>
        <li>
          <p class="paragraph">First stable preview of OkHttp 4.</p>
        </li>
      </ul>
      <h2 class=""> Version 3.x</h2>
      <p class="paragraph"><a href="https://square.github.io/okhttp/changelog_3x/">Change log</a></p>
    </div>
  </div>
</div>
      <div class="footer">
        <span class="go-to-top-icon"><a href="#content" id="go-to-top-link"></a></span><span>© 2023 Copyright</span><span
                class="pull-right"><span>Generated by </span><a
                href="https://github.com/Kotlin/dokka"><span>dokka</span><span class="padded-icon"></span></a></span>
      </div>
    </div>
</div>
</body>
</html>
